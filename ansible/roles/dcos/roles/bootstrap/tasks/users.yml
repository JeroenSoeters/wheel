- name: Install Python pip
  yum: name=python-pip state=installed

- name: Install Python kazoo module
  pip: name=kazoo

- name: Waiting for zookeper to be available
  wait_for: host={{ item }} port=2181
  with_items: "{{ groups['dcos-mesos-master'] }}"

- name: Provision dcos user
  znode:
    hosts: "{{ groups['dcos-mesos-master'][0] | regex_replace('^(.*)$', '\\1:2181') }}"
    name: "/dcos/users/{{ item }}"
    value: "{{ item }}"
    state: present
  with_items: "{{ dcos_users }}"
