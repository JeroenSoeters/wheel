- name: clear out our dcos mountpoints
  shell: "rm -rf {{ item.1.mount_point }}/*"
  with_subelements:
    - "{{ volume_groups|default([]) }}"
    - volumes
  when: "'dcos' in item.1.mount_point"

- name: uninstall package
  shell: /opt/mesosphere/bin/pkgpanda uninstall
  ignore_errors: yes

- name: remove mesosphere folder
  file: path=/opt/mesosphere state=absent

- name: remove /var/lib/dcos
  file: path=/var/lib/dcos state=absent

- name: remove /var/lib/mesos
  file: path=/var/lib/mesos state=absent

- name: remove /var/lib/mesosphere
  file: path=/var/lib/mesosphere state=absent

- name: remove /var/lib/cosmos
  file: path=/var/lib/cosmos state=absent

- name: remove /var/lib/zookeeper
  file: path=/var/lib/zookeeper state=absent

- name: remove /etc/systemd/system/dcos-setup.service
  file: path=/etc/systemd/system/dcos-setup.service state=absent

- name: remove /etc/systemd/system/dcos-download.service
  file: path=/etc/systemd/system/dcos-download.service state=absent

- name: remove /etc/systemd/system/dcos-link-env.service
  file: path=/etc/systemd/system/dcos-link-env.service state=absent

- name: remove /etc/mesosphere
  file: path=/etc/mesosphere state=absent

- name: remove install scripts
  file: path=/tmp/dcos/dcos_install.sh state=absent
